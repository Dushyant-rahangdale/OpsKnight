# ====================================================
# OpsKnight Environment Configuration
# ====================================================
# Copy this file to .env and fill in your values.
# See SECURITY.md for production security guidelines.
# ====================================================

# ----------------------------------------------------
# DATABASE
# ----------------------------------------------------
# PostgreSQL connection string with recommended production settings
# Required: Yes
DATABASE_URL="postgresql://user:password@localhost:5432/opsknight?sslmode=require&connection_limit=10&pool_timeout=30"

# Optional: Override connection pool size (default: 40)
# DATABASE_POOL_SIZE=40

# ----------------------------------------------------
# AUTHENTICATION
# ----------------------------------------------------
# Full URL of your application (required for OAuth callbacks, links in emails)
# Required: Yes
NEXTAUTH_URL="https://opsknight.yourdomain.com"

# Secret for signing JWTs and encrypting sessions
# Generate with: openssl rand -base64 32
# Note: If not set, a secret will be auto-generated and stored in the database
# NEXTAUTH_SECRET="your-secure-secret-at-least-32-characters"

# Trust the host header (set to true behind a reverse proxy)
# AUTH_TRUST_HOST=true

# JWT token refresh interval in milliseconds (default: 60000 = 1 minute)
# JWT_USER_REFRESH_TTL_MS=60000

# Auth options cache TTL in milliseconds (default: 5000)
# AUTH_OPTIONS_CACHE_TTL_MS=5000

# ----------------------------------------------------
# APPLICATION URL (for notifications and links)
# ----------------------------------------------------
# Public-facing application URL (used in emails, SMS, push notifications)
# Required: Yes (for production)
NEXT_PUBLIC_APP_URL="https://opsknight.yourdomain.com"

# ----------------------------------------------------
# ENCRYPTION
# ----------------------------------------------------
# 256-bit encryption key for sensitive data (API keys, tokens, etc.)
# Generate with: openssl rand -hex 32
# IMPORTANT: Keep this secure! Loss of this key means encrypted data cannot be recovered.
# Note: Can be stored in database via Settings UI instead of environment variable
# ENCRYPTION_KEY="0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef"

# ----------------------------------------------------
# EMAIL PROVIDERS (Configure ONE in Settings UI, or use environment variables)
# ----------------------------------------------------
# Providers are configured via Settings > System > Notification Providers
# These environment variables are optional fallbacks

# Default "from" email address
# EMAIL_FROM="noreply@yourdomain.com"

# --- Resend (recommended) ---
# RESEND_API_KEY="re_xxxxxxxxxxxx"

# --- SendGrid ---
# SENDGRID_API_KEY="SG.xxxxxxxxxxxx"

# --- Amazon SES ---
# AWS_ACCESS_KEY_ID="AKIAXXXXXXXXXXXXXXXX"
# AWS_SECRET_ACCESS_KEY="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
# AWS_SES_REGION="us-east-1"

# --- SMTP (Generic) ---
# SMTP_HOST="smtp.example.com"
# SMTP_PORT=587
# SMTP_USER="your-smtp-username"
# SMTP_PASSWORD="your-smtp-password"
# SMTP_SECURE=false

# ----------------------------------------------------
# SMS PROVIDERS (Configure in Settings UI)
# ----------------------------------------------------
# SMS providers are configured via Settings > System > Notification Providers
# These environment variables are not used directly; configure via UI instead

# --- Twilio (configured via Settings UI) ---
# Account SID, Auth Token, and From Number are set in the UI
# Install: npm install twilio

# --- AWS SNS (configured via Settings UI) ---
# Region, Access Key ID, and Secret Access Key are set in the UI
# Install: npm install @aws-sdk/client-sns

# ----------------------------------------------------
# PUSH NOTIFICATIONS
# ----------------------------------------------------
# VAPID keys for Web Push notifications
# Generate with: npx web-push generate-vapid-keys
# Can also be configured via Settings > System > Notification Providers

# Public VAPID key (shared with browser)
# NEXT_PUBLIC_VAPID_PUBLIC_KEY="BFxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"

# Private VAPID key (server-side only)
# VAPID_PRIVATE_KEY="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"

# Contact email for push notifications
# VAPID_SUBJECT="mailto:admin@yourdomain.com"

# ----------------------------------------------------
# SLACK INTEGRATION
# ----------------------------------------------------
# Configure Slack app at https://api.slack.com/apps
# Can also be configured via Settings > Integrations > Slack

# Slack OAuth App credentials
# SLACK_CLIENT_ID="1234567890.1234567890123"
# SLACK_CLIENT_SECRET="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
# SLACK_REDIRECT_URI="https://opsknight.yourdomain.com/api/slack/oauth/callback"

# Slack Bot Token (for API calls)
# SLACK_BOT_TOKEN="xoxb-xxxxxxxxxxxx-xxxxxxxxxxxx-xxxxxxxxxxxxxxxxxxxxxxxx"

# Slack Signing Secret (for verifying incoming webhooks)
# SLACK_SIGNING_SECRET="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"

# Legacy: Simple webhook URL for notifications (deprecated, use OAuth instead)
# SLACK_WEBHOOK_URL="https://hooks.slack.com/services/T00000000/B00000000/XXXXXXXXXXXXXXXXXXXXXXXX"

# ----------------------------------------------------
# OIDC / SSO (Enterprise)
# ----------------------------------------------------
# OIDC is configured via Settings > Security > SSO
# These environment variables control caching behavior

# OIDC configuration cache TTL in milliseconds (default: 5000)
# OIDC_CONFIG_CACHE_TTL_MS=5000

# OIDC record cache TTL in milliseconds (default: 5000)
# OIDC_CONFIG_RECORD_CACHE_TTL_MS=5000

# Require email_verified claim for OIDC logins (default: false)
# OIDC_REQUIRE_EMAIL_VERIFIED_STRICT=false

# ----------------------------------------------------
# FEATURE FLAGS
# ----------------------------------------------------
# Enable/disable internal cron scheduler (default: true)
# Set to "false" if using external cron (e.g., Kubernetes CronJob)
# ENABLE_INTERNAL_CRON=true

# Disable PWA features (default: disabled in development)
# DISABLE_PWA=false

# ----------------------------------------------------
# CORS & SECURITY
# ----------------------------------------------------
# Comma-separated list of allowed origins for CORS
# Leave empty to allow only same-origin requests
# CORS_ALLOWED_ORIGINS="https://app.yourdomain.com,https://admin.yourdomain.com"

# Status page domain cache TTL in seconds (default: 60)
# STATUS_PAGE_DOMAIN_CACHE_TTL=60

# ----------------------------------------------------
# INTEGRATIONS
# ----------------------------------------------------
# Verify incoming webhook signatures (default: true)
# Set to "false" only for testing
# INTEGRATION_VERIFY_SIGNATURES=true

# Enable rate limiting for integrations (default: true)
# INTEGRATION_RATE_LIMIT=true

# ----------------------------------------------------
# SLA MONITORING
# ----------------------------------------------------
# Email to receive SLA breach alerts
# SLA_ALERT_EMAIL="oncall@yourdomain.com"

# ----------------------------------------------------
# LOGGING & DEBUGGING
# ----------------------------------------------------
# Log level: debug, info, warn, error (default: info)
# LOG_LEVEL=info

# Log format: text or json (default: text in dev, auto-detected in production)
# LOG_FORMAT=json

# Maximum log buffer size (default: 500)
# LOG_BUFFER_MAX=500

# ----------------------------------------------------
# PERFORMANCE
# ----------------------------------------------------
# Event transaction max retry attempts (default: 3)
# EVENT_TRANSACTION_MAX_ATTEMPTS=3

# Escalation lock timeout in milliseconds (default: 300000 = 5 minutes)
# ESCALATION_LOCK_TIMEOUT_MS=300000

# ----------------------------------------------------
# ERROR TRACKING (Optional)
# ----------------------------------------------------
# Sentry DSN for error tracking
# SENTRY_DSN="https://xxxx@xxxx.ingest.sentry.io/xxxx"

# Sentry environment (production, staging, development)
# SENTRY_ENVIRONMENT="production"

# ----------------------------------------------------
# BUILD & DEVELOPMENT
# ----------------------------------------------------
# Custom build output directory (default: .next)
# BUILD_DIR=.next

# Node environment (automatically set by Next.js)
# NODE_ENV=production
